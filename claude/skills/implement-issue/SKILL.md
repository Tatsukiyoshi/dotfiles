---
name: implement-issue
description: GitHub Issueを実装し、ブランチ作成からPR作成まで一貫して行う。Issue番号を引数に取る。
user-invocable: true
argument-hint: [issue-number]
---

# Issue実装ワークフロー

GitHub Issue **#$ARGUMENTS** を実装する。以下の手順に従って作業すること。

## 1. Issue確認

- `gh issue view $ARGUMENTS` でIssueの内容を確認する
- 要件・実装タスク・関連情報を把握する

## 2. ブランチ作成

- mainブランチから新しいブランチを作成する
- ブランチ名: `feature/issue-$ARGUMENTS-{概要の英語要約}`
- `.claude/instructions.md` の「Git/PR Workflow」セクションに従うこと

## 3. 開発ノートの事前確認（必須）

実装を開始する**前に** `docs/DEVELOPMENT_NOTES.md` を読み、過去の知見を把握する。**このステップは省略不可。**

- 特に、これから実装する領域に関連するカテゴリ（UI/UX設計、テスト手法、実装）を重点的に確認する
- 過去に記録された回避策・ベストプラクティスを実装・テストに反映すること
- 例: ESLintのimport/order規則、Vitestモックパターン、Prismaの型定義パターンなど
- **確認結果をユーザーに報告すること:**
  - 参考になった知見がある場合: どの知見（カテゴリ名・番号）がどう役立つかを報告する
  - 参考になる知見がなかった場合: その理由を報告する（例:「今回の実装領域に関連する既存知見がなかった」等）

## 4. 実装

- Issueに記載された要件に沿って実装する
- 既存のコードパターン・命名規則・ディレクトリ構造に従うこと
- `.claude/instructions.md` と `.claude/test_instructions.md` のガイドラインを遵守すること
- React/Next.jsコードの場合は `.claude/skills/react-best-practices/SKILL.md` にも従うこと
- **他のIssueも一緒に対応できると判断した場合:** ユーザーに報告し、了承を得た上で対応範囲を広げること。勝手にスコープを拡大しない

## 5. テスト作成

- 実装したコードに対する単体テストを作成する
- `.claude/test_instructions.md` の厳守事項に従うこと
  - 意味のないアサーション禁止
  - ハードコーディング禁止
  - 境界値・異常系もテストすること

## 6. 品質チェック

以下を全て通過させること:

```bash
bun run test       # テスト実行
bun run lint       # ESLint（0 warnings）
bun run type-check # TypeScript型チェック
```

## 7. 開発ノート振り返り（必須）

実装を振り返り、以下の観点で記録すべき知見がないか確認する。**このステップは省略不可。**

- ステップ3で確認した既存の知見が実装に役立ったか振り返る
- パッケージの互換性問題や回避策
- 型エラーの解決方法
- フレームワーク・ライブラリの挙動に関する気づき
- 設定変更やベストプラクティス

**知見がある場合:** `docs/DEVELOPMENT_NOTES.md` に追記する。
- 適切なカテゴリ（UI/UX設計、テスト手法、実装）を選択する。
- カテゴリ内で独立した通し番号（1...）を振る。
- 詳細な記録フォーマットは `CLAUDE.md` の「開発メモの管理」セクションに従うこと。
- 追記した内容とカテゴリをユーザーに報告する。

**知見がない場合:** 以下を行う。
- 記録不要と判断した理由をユーザーに報告する（例:「既存パターンの範囲内で新たな問題は発生しなかった」等）。
- 対象Issueに `gh issue comment` で振り返り結果をコメントする。
- PR作成後、PRにも `gh pr comment` で同様のコメントを残す。

## 8. コミット＆プッシュ

- 変更内容を適切な粒度でコミットする
- コミットメッセージは既存のコミット履歴のスタイルに合わせること
- リモートにプッシュする

## 9. プルリクエスト作成

- `gh pr create` でPRを作成する
- タイトル: 簡潔に変更内容を表す（70文字以内）
- 本文: Summary（箇条書き）、Test plan（テスト手順チェックリスト）を含める
- `Closes #$ARGUMENTS` を本文に含めてIssueを自動クローズする
- PR URLを最後に表示する
